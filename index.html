<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>VenusDate - Your dating partner!</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
</head>
<link rel="stylesheet" href="assets/override.css">
<link rel="stylesheet" href="assets/app.css">
</head>
<body>
<header class="mb-auto header">
    <div class="container">
        <div class="inner">
            <nav class="nav p-4">
                <h3 class="nav-brand"><img src="./assets/logo.png" alt="VenusDate - Your perfect date!"></h3>
                <button class="btn btn-primary" data-bs-target="#registerModal" data-bs-toggle="modal">Login</button>
            </nav>
        </div>
    </div>
</header>
<footer class="mt-auto  p-4">
    <div class="container text-center">
        <p>Â© 2022 VenusDate.com All rights reserved</p>
        <a href="#">Terms and Conditions</a>
        <span>|</span>
        <a href="#">Privacy Policy</a>
    </div>
</footer>
<main class="modal fade show" id="registerModal" aria-hidden="true" aria-labelledby="registerModalLabel" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <h1 class="modal-title fs-2 text-center pt-4" id="registerModalLabel">Embark on your love journey!</h1>
                <p class="modal-title text-center p-4 mb-3">Connect with singles via a secure and instant match-making
                    platform</p>
                <div class="register-timer mb-3">
                    <span class="register-timer-label">
                        Registration stops:
                    </span>
                    <span id="register-timer-value" class="register-timer-value">
                        05:00
                    </span>
                </div>
                <form id="registerForm"
                      class="rounded border p-4 text-white needs-validation"
                      method="POST"
                      action="#"
                      accept-charset="UTF-8" novalidate>
                    <div id="step-1" class="step form-group" data-step="1">
                        <label for="gender_m" class="form-label">I am</label>
                        <div class="row mx-n2">
                            <div class="col-sm-6 px-2">
                                <div class="form-check" data-id="form-gender">
                                    <label for="gender_m" class="btn btn-block btn-primary">
                                        <input type="radio" class="form-check-input" value="m"
                                               name="gender"
                                               id="gender_m" checked>
                                        A man
                                    </label>
                                </div>
                            </div>
                            <div class="col-sm-6 px-2">
                                <div class="form-check" data-id="form-gender">
                                    <label class="btn btn-block btn-outline-primary" for="gender_f">
                                        <input type="radio" class="form-check-input" value="f" name="gender"
                                               id="gender_f">
                                        A women
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="step-2" class="step d-none form-group" data-step="2">
                        <label for="looking_for_gender_m" class="form-label">Seeking</label>
                        <div class="row mx-n2">
                            <div class="col-6 col-sm-6px-2">
                                <div class="form-check" data-id="form-seeking-gender">
                                    <label for="looking_for_gender_m" class="btn btn-block btn-outline-primary">
                                        <input type="radio" class="form-check-input" name="looking_for_gender"
                                               id="looking_for_gender_m"
                                               value="m"/>
                                        A man
                                    </label>
                                </div>
                            </div>
                            <div class="col-6 col-sm-6px-2">
                                <div class="form-check" data-id="form-seeking-gender">
                                    <label for="looking_for_gender_f" class="btn btn-block btn-primary">
                                        <input type="radio" class="form-check-input" name="looking_for_gender"
                                               id="looking_for_gender_f"
                                               value="f" checked/>
                                        A women
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="step-3" class="step d-none form-group" data-step="3">
                        <label for="looking_for_gender_m" class="form-label">Username</label>
                        <input class="form-control" type="text" placeholder="Enter your username" name="username"
                               id="username" maxlength="15">
                        <div class="invalid-feedback">
                            Please enter your username.
                        </div>
                    </div>
                    <div id="step-4" class="step d-none form-group" data-step="4">
                        <label for="looking_for_gender_m" class="form-label">Date of Birth</label>
                        <div class="row mx-n2">
                            <div class="col-4-sm px-2">
                                <select class="form-control" name="dobday" id="dobday">
                                    <option value="">Day</option>
                                </select>
                                <div class="invalid-feedback">
                                    Required.
                                </div>
                            </div>
                            <div class="col-4-sm px-2">
                                <select class="form-control" name="dobmonth" id="dobmonth">
                                    <option value="">Month</option>
                                </select>
                                <div class="invalid-feedback">
                                    Required.
                                </div>
                            </div>
                            <div class="col-4-sm px-2">
                                <select class="form-control" name="dobyear" id="dobyear">
                                    <option value="">Year</option>
                                </select>
                                <div class="invalid-feedback">
                                    Required.
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="step-5" class="step d-none form-group" data-step="5">
                        <label for="email" class="form-label">Email</label>
                        <input name="email" id="email" class="form-control" type="email" placeholder="Enter your email">
                        <div class="invalid-feedback">
                            Please enter your email.
                        </div>
                    </div>
                    <div id="step-6" class="step d-none form-group" data-step="6">
                        <div class="row mx-n2">
                            <div class="col-12">
                                <div class="mb-3">
                                    <label for="password" class="form-label">Password</label>
                                    <input name="password" id="password" class="form-control"
                                           type="password" placeholder="Enter your password"
                                    >
                                    <div class="invalid-feedback">
                                        Please enter your password.
                                    </div>
                                </div>
                            </div>
                            <div class="col-12">
                                <label for="tac_accepted">
                                    <input class="form-check-input" type="checkbox" id="tac_accepted"
                                           name="tac_accepted" value="1"/>
                                    <small>By clicking below to register, you confirm that you agree to our <a href="#">T
                                        &
                                        Cs</a> and you have read and understood our <a href="#">Privacy
                                        Policy</a>.</small>
                                    <div class="invalid-feedback">
                                        Please accept T & Cs to proceed.
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="mt-5 form-group">
                        <div class="row mx-n2">
                            <div class="col-12 px-2">
                                <button id="btn-continue" class="btn btn-block btn-lg btn btn-primary"
                                        type="submit"
                                        data-role="submit">
                                    Continue
                                </button>
                            </div>
                            <div class="col-12 px-2 d-none">
                                <button id="btn-submit" class="btn btn-block btn-lg btn btn-primary"
                                        type="submit"
                                        data-role="submit">
                                    Join now
                                </button>
                            </div>
                            <div class="col-6 px-2 d-none mt-3 mx-auto">
                                <button id="btn-previous" class="btn btn-block btn-lg btn btn-outline-light"
                                        type="button"
                                        data-role="previous">
                                    < Previous
                                </button>
                            </div>
                            <div class="col-12 d-none">
                                Already have an account? <a href="/#login">Login here</a>.
                            </div>
                        </div>
                    </div>
                </form>
                <div id="alert-success" class="step d-none">
                    <div class="alert alert-success p-10" role="alert">
                        <h3 class="fs-3">Thank you for registering with VenusDate!</h3>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.6/dist/umd/popper.min.js"
        integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>
<script type="text/javascript">
    const TOTAL_STEPS = 6;
    let currentStep = 1;
    let FORM_STEPS = [
        {
            step: 1,
            fields: []
        },
        {
            step: 2,
            fields: []
        },
        {
            step: 3,
            fields: ['username']
        },
        {
            step: 4,
            fields: [
                'dobday',
                'dobmonth',
                'dobyear',
            ]
        },
        {
            step: 5,
            fields: [
                'email',
            ]
        },
        {
            step: 6,
            fields: [
                'password',
                'tac_accepted',
            ]
        }
    ];

    const setup = function () {
        setTimer();

        setFormActions();

        setModal();

        setDayOptions();

        setMonthOptions();

        setYearOptions();
    };

    const setModal = function () {
        const options = {
            backdrop: 'static'
        };
        const registerModal = new bootstrap.Modal('#registerModal', options);
        registerModal.show();
    }

    const setFormActions = function () {
        $('.form-check').click(onFormCheck);
        $('#btn-previous').click(onPrevStep);
    }

    const onNextStep = function () {
        currentStep += 1;
        processStep();

        let step = Array.from(FORM_STEPS).find(item => item.step === currentStep);

        step.fields.forEach(field => {
            $('#' + field).attr("required", "true");
        })
    };

    const onPrevStep = function () {
        let step = Array.from(FORM_STEPS).find(item => item.step === currentStep);
        step.fields.forEach(field => {
            $('#' + field).removeAttr("required");
        })

        currentStep -= 1;
        processStep();
    };

    const processStep = function () {
        $('.step').addClass('d-none');
        $('#step-' + currentStep).removeClass('d-none');

        if (currentStep == 1) {
            $('input:radio[name="gender"]').filter('[value="m"]').attr('checked', true);
            $('#btn-previous').parent().addClass('d-none');
        } else if (currentStep < TOTAL_STEPS) {
            $('#btn-previous').parent().removeClass('d-none');
            $('#btn-continue').parent().removeClass('d-none');
            $('#btn-submit').parent().addClass('d-none');
        } else if (currentStep === TOTAL_STEPS) {
            $('#btn-continue').parent().addClass('d-none');
            $('#btn-submit').parent().removeClass('d-none');
        }
    }

    const MINUTES_LIMIT = 5;
    const SECONDS_LIMIT = 60;
    let timerMinutes = MINUTES_LIMIT - 1;
    let timerSeconds = SECONDS_LIMIT - 1;

    const setDayOptions = function () {
        const days = Array.from({length: 31}, (_, i) => i + 1);

        let dayOptions = ''
        days.forEach(day => {
            dayOptions += `<option value="${day}">${day < 10 ? '0' + day : day}</option>`
        })
        $('#dobday').append(dayOptions)
    }
    const setMonthOptions = function () {
        const months = [
            "January",
            "February",
            "March",
            "April",
            "May",
            "June",
            "July",
            "August",
            "September",
            "October",
            "November",
            "December"
        ];

        let monthOptions = ''
        months.forEach((month, index) => {
            monthOptions += `<option value="${index + 1}">${month}</option>`
        })
        $('#dobmonth').append(monthOptions)
    }
    const setYearOptions = function () {
        const AGE_LOWER_LIMIT = 16; // approx: over 18 years
        const AGE_UPPER_LIMIT = 100; // approx: under 100 years

        const date = new Date();
        const years = Array.from({length: AGE_UPPER_LIMIT - AGE_LOWER_LIMIT}, (_, i) => date.getFullYear() - (AGE_LOWER_LIMIT + i));

        let yearOptions = ''
        years.forEach((year, index) => {
            yearOptions += `<option value="${year}">${year}</option>`
        })
        $('#dobyear').append(yearOptions);
    }

    const setTimer = function () {
        let timerValue = '';

        setInterval(function () {
            timerSeconds -= 1;

            if (timerSeconds < 0) {
                timerMinutes -= 1;
                timerSeconds = SECONDS_LIMIT;
            }

            if (timerMinutes < 0) {
                timerMinutes = MINUTES_LIMIT - 1;
            }

            timerValue = `0${timerMinutes}:${timerSeconds >= 10 ? timerSeconds : '0' + timerSeconds}`;
            $('#register-timer-value').html(timerValue);
        }, 100);
    };

    const onFormCheck = function () {
        const formCheck = $(this);

        const dataId = formCheck.attr('data-id');

        const inputElement = formCheck.find('input');
        const btnElement = formCheck.find('.btn');
        const isChecked = inputElement.prop('checked');

        const btnElements = $('.form-check[data-id=' + dataId + '] .btn');

        toggleCheck(btnElements, false);
        toggleCheck(btnElement, isChecked);
    };

    const toggleCheck = function (selector, toggle) {
        if (toggle) {
            selector.removeClass('btn-outline-primary');
            selector.addClass('btn-primary');
        } else {
            selector.removeClass('btn-primary');
            selector.addClass('btn-outline-primary');
        }
    }

    const validateForm = function () {
        // Fetch all the forms we want to apply custom Bootstrap validation styles to
        const forms = document.querySelectorAll('.needs-validation')

        // Loop over them and prevent submission
        Array.from(forms).forEach(form => {
            form.addEventListener('submit', function (event) {
                event.preventDefault()
                event.stopPropagation()

                form.classList.remove('was-validated')

                if (currentStep < TOTAL_STEPS) {
                    if (form.checkValidity()) {
                        onNextStep();
                    } else {
                        form.classList.add('was-validated')
                    }
                } else if (form.checkValidity()) {
                    $('#alert-success').removeClass('d-none');
                    $('#registerForm, .register-timer').addClass('d-none');
                }
            }, true)
        })
    }

    $(document).ready(function () {
        setup();
    });

    (() => {
        'use strict'
       validateForm()
    })()
</script>
</body>
</html>
